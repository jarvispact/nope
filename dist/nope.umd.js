(function(a,c){typeof exports=="object"&&typeof module!="undefined"?c(exports):typeof define=="function"&&define.amd?define(["exports"],c):(a=typeof globalThis!="undefined"?globalThis:a||self,c(a.io={}))})(this,function(a){"use strict";const c=(e,t,o,l)=>({schema:e,code:t,message:o,details:l}),f=e=>Object.keys(e),g=e=>typeof e=="object"&&!Array.isArray(e)&&e!==null,u=e=>e===null?"null":e instanceof Date?"date":g(e)?"record":Array.isArray(e)?"array":typeof e,E=e=>({status:"SUCCESS",value:e}),d=e=>({status:"FAILURE",value:e}),b=e=>e.status==="SUCCESS",w=e=>e.status==="FAILURE",S=e=>e.value,N=(e,{onSuccess:t,onFailure:o})=>b(e)?t(e.value):o(e.value),A=e=>e.schema==="string-literal"||e.schema==="number-literal",p=e=>e.schema==="record",I=e=>c("array","E_NOT_A_ARRAY",'provided value is not of type: "array"',{provided:{type:u(e),value:e},expected:{type:"array"}}),R=(e,t)=>{if(Array.isArray(t)&&t.length<1)throw new Error("array() was called with an empty constraints array. provide at least 1 constraint or call array() without array argument.");return{schema:"array",I:null,O:null,E:null,validate:n=>{if(!Array.isArray(n))return d({errors:[I(n)],items:[]});const i=(t||[]).map(v=>{if(!!v.when(n))return v.error(n)}).filter(Boolean),m=n.map(v=>e.validate(v)),y=m.some(v=>v.status==="FAILURE");return i.length||y?d({errors:i,items:m}):E(n)}}},C=({when:e,error:t})=>({when:e,error:o=>{const{code:l,message:s,details:r}=t(o);return c("array",l,s,{provided:{type:u(o),value:o},constraint:r})}}),T=e=>c("boolean","E_NOT_A_BOOLEAN",'provided value is not of type: "boolean"',{provided:{type:u(e),value:e},expected:{type:"boolean"}}),L=()=>({schema:"boolean",I:null,O:null,E:null,validate:s=>typeof s=="boolean"?E(s):d(T(s))}),j=e=>c("date","E_NOT_A_DATE",'provided value is not of type: "date"',{provided:{type:u(e),value:e},expected:{type:"date"}}),D=e=>c("date","E_INVALID_DATE","provided date is invalid",{provided:{type:u(e),value:e},expected:{type:"date"}}),U=e=>{if(Array.isArray(e)&&e.length<1)throw new Error("date() was called with an empty constraints array. provide at least 1 constraint or call date() without array argument.");return{schema:"date",I:null,O:null,E:null,validate:r=>{if(!(r instanceof Date))return d([j(r)]);if(r.toString()==="Invalid Date")return d([D(r)]);const n=(e||[]).map(i=>{if(!!i.when(r))return i.error(r)}).filter(Boolean);return n.length?d(n):E(r)}}},k=({when:e,error:t})=>({when:e,error:o=>{const{code:l,message:s,details:r}=t(o);return c("date",l,s,{provided:{type:u(o),value:o},constraint:r})}}),h=e=>typeof e=="string"?"string-literal":"number-literal",B=e=>typeof e=="string"?"E_INVALID_STRING_LITERAL":"E_INVALID_NUMBER_LITERAL",M=e=>typeof e=="string"?`provided value is not of type: "string-literal("${e}")"`:`provided value is not of type: "number-literal(${e})"`,F=(e,t)=>c(h(e),B(e),M(e),{provided:{type:u(t),value:t},expected:{type:h(e),literal:e}}),K=e=>{const t=e,o=null,l=null,s=null,r=n=>n===e?E(n):d(F(e,n));return{schema:h(t),literal:t,I:o,O:l,E:s,validate:r}},G=e=>({schema:"nullable",I:null,O:null,E:null,validate:r=>r===null?E(null):e.validate(r)}),V=e=>c("number","E_NOT_A_NUMBER",'provided value is not of type: "number"',{provided:{type:u(e),value:e},expected:{type:"number"}}),Y=e=>{if(Array.isArray(e)&&e.length<1)throw new Error("number() was called with an empty constraints array. provide at least 1 constraint or call number() without array argument.");return{schema:"number",I:null,O:null,E:null,validate:r=>{if(typeof r!="number")return d([V(r)]);const n=(e||[]).map(i=>{if(!!i.when(r))return i.error(r)}).filter(Boolean);return n.length?d(n):E(r)}}},$=({when:e,error:t})=>({when:e,error:o=>{const{code:l,message:s,details:r}=t(o);return c("number",l,s,{provided:{type:u(o),value:o},constraint:r})}}),H=e=>({schema:"optional",I:null,O:null,E:null,validate:r=>r===void 0?E(void 0):e.validate(r)}),O=(e,t)=>c("record","E_NOT_A_RECORD",'provided value is not of type: "record"',{provided:{type:u(t),value:t},expected:{type:"record",keys:Object.keys(e)}}),z=(e,t)=>c("record","E_MISSING_RECORD_KEYS","record has missing keys",{provided:{type:u(t),value:t},expected:{type:"record",keys:Object.keys(e)}}),J=(e,t)=>c("record","E_UNKNOWN_RECORD_KEYS","record has unknown keys",{provided:{type:u(t),value:t,keys:Object.keys(t)},expected:{type:"record",keys:Object.keys(e)}}),_=e=>({schema:"record",I:null,O:null,E:null,validate:r=>{if(!g(r))return d({errors:[O(e,r)],properties:{}});const n=[];f(e).length>f(r).length&&n.push(z(e,r)),f(r).length>f(e).length&&n.push(J(e,r));const i=f(e).reduce((y,v)=>(y[v]=e[v].validate(r[v]),y),{}),m=f(i).some(y=>i[y].status==="FAILURE");return n.length||m?d({errors:n,properties:i}):E(r)},definition:e}),P=e=>({schema:"partial",I:null,O:null,E:null,validate:r=>{if(!g(r))return d({errors:[O(e.definition,r)],properties:{}});const n=Object.fromEntries(Object.entries(e.definition).filter(([i])=>f(r).includes(i)));return _(n).validate(r)}}),W=e=>c("string","E_NOT_A_STRING",'provided value is not of type: "string"',{provided:{type:u(e),value:e},expected:{type:"string"}}),q=e=>{if(Array.isArray(e)&&e.length<1)throw new Error("string() was called with an empty constraints array. provide at least 1 constraint or call string() without array argument.");return{schema:"string",I:null,O:null,E:null,validate:r=>{if(typeof r!="string")return d([W(r)]);const n=(e||[]).map(i=>{if(!i.when(r))return;const{code:m,message:y,details:v}=i.error(r);return c("string",m,y,v)}).filter(Boolean);return n.length?d(n):E(r)}}},Q=({when:e,error:t})=>({when:e,error:o=>{const{code:l,message:s,details:r}=t(o);return c("string",l,s,{provided:{type:u(o),value:o},constraint:r})}}),X=(e,t)=>c("union","E_NOT_IN_UNION",'provided value is not in type: "union"',{provided:{type:u(t),value:t},expected:{type:"union",union:e}}),Z=e=>{const t=null,o=null,l=null,s=e.map(n=>A(n)?n.literal:p(n)?`record(${JSON.stringify(Object.fromEntries(Object.entries(n.definition).map(([i,m])=>[i,m.schema])))})`:n.schema);return{schema:"union",I:t,O:o,E:l,validate:n=>e.map(y=>y.validate(n)).some(y=>y.status==="SUCCESS")?E(n):d(X(s,n))}};a.array=R,a.arrayConstraint=C,a.boolean=L,a.date=U,a.dateConstraint=k,a.failure=d,a.fold=N,a.isFailure=w,a.isLiteralSchema=A,a.isRecordSchema=p,a.isSuccess=b,a.literal=K,a.notAArray=I,a.notARecordError=O,a.nullable=G,a.number=Y,a.numberConstraint=$,a.optional=H,a.partial=P,a.record=_,a.string=q,a.stringConstraint=Q,a.success=E,a.union=Z,a.valueOf=S,Object.defineProperty(a,"__esModule",{value:!0}),a[Symbol.toStringTag]="Module"});
